name: NetsurfP2_CNNbLSTM_HHBlits
save_dir: saved/NetsurfP2_CNNbLSTM_HHBlits/
seed: 1234
target_devices: [0]

arch:
  type: CNNbLSTM
  args:
    init_n_channels: 50
    out_channels: 32
    cnn_layers: 2
    kernel_size: [129, 257]
    padding: [64, 128]
    n_hidden: 50
    dropout: 0.5
    lstm_layers: 2

dataset_loader:
  type: NSPData

data_loader:
  type: NSPDataLoader
  args:
    batch_size: 15
    file: ../data/nsp2/training_data/Train_HHBlits.npz
    nworkers: 2
    shuffle: true
    validation_split: 0.05

loss: multi_task_loss

metrics:
- metric_ss8
- metric_ss3
- metric_dis_mcc
- metric_dis_fpr
- metric_rsa
- metric_asa
- metric_phi
- metric_psi

optimizer:
  type: Adam
  args:
    lr: 5e-3
    weight_decay: 0

training:
  early_stop: 10
  epochs: 100
  monitor: min val_loss
  save_period: 1
  tensorboard: true
